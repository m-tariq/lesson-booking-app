"use strict";(self["webpackChunklesson_booking_app"]=self["webpackChunklesson_booking_app"]||[]).push([[969],{1969:function(e,t,a){a.r(t),a.d(t,{default:function(){return re}});var s=a(6768);function r(e,t,a,r,i,o){const n=(0,s.g2)("ShoppingCart");return(0,s.uX)(),(0,s.Wv)(n)}var i=a(4232),o=a(5130);const n={class:"container py-4"},c={class:"d-flex justify-content-between align-items-center mb-4"},l={key:0,class:"text-center py-5"},m={key:1,class:"alert alert-danger",role:"alert"},d={key:2,class:"text-center py-5"},u={key:3,class:"row"},h={class:"col-lg-8"},k={class:"card border-0 shadow-sm mb-4"},b={class:"card-body"},p={class:"cart-items"},v={class:"col-lg-4"},y={class:"card border-0 shadow-sm"},L={class:"card-body"},C={class:"price-summary mb-4"},f={class:"d-flex justify-content-between mb-3"},g={class:"fw-bold"},F={class:"mb-3"},I={class:"invalid-feedback"},w={class:"mb-3"},q={class:"invalid-feedback"},x={class:"d-grid gap-2"},_=["disabled"];function S(e,t,a,r,S,X){const E=(0,s.g2)("router-link"),Q=(0,s.g2)("cartItem");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",c,[t[5]||(t[5]=(0,s.Lk)("h2",{class:"fw-bold mb-0"},"Shopping Cart",-1)),e.hasItems?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=(...t)=>e.clearCart&&e.clearCart(...t)),class:"btn btn-outline-danger btn-sm"},t[4]||(t[4]=[(0,s.Lk)("i",{class:"bi bi-trash me-2"},null,-1),(0,s.eW)("Clear Cart ")]))):(0,s.Q3)("",!0)]),S.loading?((0,s.uX)(),(0,s.CE)("div",l,t[6]||(t[6]=[(0,s.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,s.Lk)("span",{class:"visually-hidden"},"Loading...")],-1)]))):e.error?((0,s.uX)(),(0,s.CE)("div",m,(0,i.v_)(e.error),1)):e.hasItems?((0,s.uX)(),(0,s.CE)("div",u,[(0,s.Lk)("div",h,[(0,s.Lk)("div",k,[(0,s.Lk)("div",b,[(0,s.Lk)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.sortedCartItems,(t=>((0,s.uX)(),(0,s.CE)("div",{key:t.id,class:"cart-item p-3 mb-3 bg-light rounded"},[(0,s.bF)(Q,{item:t,onRemove:X.handleRemoveItem,onUpdateQuantity:e.handleUpdateQuantity},null,8,["item","onRemove","onUpdateQuantity"])])))),128))])])])]),(0,s.Lk)("div",v,[(0,s.Lk)("div",y,[(0,s.Lk)("div",L,[t[15]||(t[15]=(0,s.Lk)("h5",{class:"card-title mb-4"},"Order Summary",-1)),(0,s.Lk)("div",C,[(0,s.Lk)("div",f,[t[11]||(t[11]=(0,s.Lk)("span",{class:"fw-bold"},"Total",-1)),(0,s.Lk)("span",g,(0,i.v_)(e.cartTotal),1)])]),(0,s.Lk)("form",{onSubmit:t[3]||(t[3]=(0,o.D$)(((...e)=>X.handleCheckout&&X.handleCheckout(...e)),["prevent"]))},[(0,s.Lk)("div",F,[t[12]||(t[12]=(0,s.Lk)("label",{class:"form-label"},"Name",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>S.checkoutForm.name=e),class:(0,i.C4)(["form-control",{"is-invalid":S.errors.name}]),required:""},null,2),[[o.Jo,S.checkoutForm.name]]),(0,s.Lk)("div",I,(0,i.v_)(S.errors.name),1)]),(0,s.Lk)("div",w,[t[13]||(t[13]=(0,s.Lk)("label",{class:"form-label"},"Phone",-1)),(0,s.bo)((0,s.Lk)("input",{type:"tel","onUpdate:modelValue":t[2]||(t[2]=e=>S.checkoutForm.phone=e),class:(0,i.C4)(["form-control",{"is-invalid":S.errors.phone}]),required:""},null,2),[[o.Jo,S.checkoutForm.phone]]),(0,s.Lk)("div",q,(0,i.v_)(S.errors.phone),1)]),(0,s.Lk)("div",x,[(0,s.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:S.loading||!X.isFormValid},[t[14]||(t[14]=(0,s.Lk)("i",{class:"bi bi-credit-card me-2"},null,-1)),(0,s.eW)(" Checkout ("+(0,i.v_)(e.cartItemCount)+" items) ",1)],8,_)])],32)])])])])):((0,s.uX)(),(0,s.CE)("div",d,[t[8]||(t[8]=(0,s.Lk)("i",{class:"bi bi-cart-x display-1 text-muted"},null,-1)),t[9]||(t[9]=(0,s.Lk)("h3",{class:"mt-3"},"Your cart is empty",-1)),t[10]||(t[10]=(0,s.Lk)("p",{class:"text-muted mb-4"},"Add some lessons to get started",-1)),(0,s.bF)(E,{to:"/lessons",class:"btn btn-primary"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.Lk)("i",{class:"bi bi-book me-2"},null,-1),(0,s.eW)("Browse Lessons ")]))),_:1})]))])}a(4114),a(1454);var X=a(782);const E={class:"cart-item-container"},Q={class:"d-flex justify-content-between align-items-center flex-wrap"},j={class:"d-flex align-items-center subject-info"},W={class:"subject-icon me-3"},$={class:"mb-1"},D={class:"text-muted small mb-1"},O={class:"text-muted small"},P={class:"controls-section"},R={class:"quantity-wrapper me-4"},T={class:"quantity-control d-flex align-items-center"},U=["disabled"],V={class:"quantity-display mx-3"},A=["disabled"],N={class:"price-remove-section text-end"},J={class:"price-section mb-2"},B={class:"fw-bold"},H={key:0,class:"text-muted"};function K(e,t,a,r,o,n){return(0,s.uX)(),(0,s.CE)("div",E,[(0,s.Lk)("div",Q,[(0,s.Lk)("div",j,[(0,s.Lk)("div",W,[(0,s.Lk)("i",{class:(0,i.C4)([a.item?.icon,"fs-3"])},null,2)]),(0,s.Lk)("div",null,[(0,s.Lk)("h5",$,(0,i.v_)(a.item.subject),1),(0,s.Lk)("div",D,[t[3]||(t[3]=(0,s.Lk)("i",{class:"bi bi-geo-alt me-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)(a.item.location),1)]),(0,s.Lk)("div",O,[t[4]||(t[4]=(0,s.Lk)("i",{class:"bi bi-person me-1"},null,-1)),(0,s.eW)(" "+(0,i.v_)(n.availableSpaces)+" remaining ",1)])])]),(0,s.Lk)("div",P,[(0,s.Lk)("div",R,[t[7]||(t[7]=(0,s.Lk)("label",{class:"form-label small text-muted mb-2"},"Quantity:",-1)),(0,s.Lk)("div",T,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>n.updateQuantity(a.item.quantity-1)),class:"btn btn-outline-secondary btn-sm",disabled:a.item.quantity<=1,title:"Decrease quantity"},t[5]||(t[5]=[(0,s.Lk)("i",{class:"bi bi-dash"},null,-1)]),8,U),(0,s.Lk)("span",V,(0,i.v_)(a.item.quantity),1),(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>n.updateQuantity(a.item.quantity+1)),class:"btn btn-outline-secondary btn-sm",disabled:a.item.quantity>=a.item.spaces,title:"Increase quantity"},t[6]||(t[6]=[(0,s.Lk)("i",{class:"bi bi-plus"},null,-1)]),8,A)])]),(0,s.Lk)("div",N,[(0,s.Lk)("div",J,[(0,s.Lk)("div",B,"£"+(0,i.v_)(n.totalPrice),1),a.item.quantity>1?((0,s.uX)(),(0,s.CE)("small",H," £"+(0,i.v_)(a.item.price)+" each ",1)):(0,s.Q3)("",!0)]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>n.removeItem&&n.removeItem(...e)),class:"btn btn-outline-danger btn-sm",title:"Remove from cart"},t[8]||(t[8]=[(0,s.Lk)("i",{class:"bi bi-trash me-1"},null,-1),(0,s.eW)(" Remove ")]))])])])])}var Y={name:"CartItem",props:{item:{type:Object,required:!0,validator:e=>["id","subject","location","price","spaces","quantity","icon"].every((t=>t in e))}},computed:{totalPrice(){return this.item.price*this.item.quantity},availableSpaces(){const e=this.item.spaces-this.item.quantity;return`${e} space${1!==e?"s":""}`}},methods:{updateQuantity(e){this.$store.dispatch("cart/updateQuantity",{lessonId:this.item.id,quantity:e})},removeItem(){this.$emit("remove",this.item)}}},z=a(1241);const G=(0,z.A)(Y,[["render",K],["__scopeId","data-v-048cfa6a"]]);var M=G,Z={name:"CartView",components:{cartItem:M},data(){return{checkoutForm:{name:"",phone:""},errors:{name:"",phone:""},loading:!1}},computed:{...(0,X.aH)("cart",["error"]),...(0,X.L8)("cart",["sortedCartItems","hasItems","cartItemCount","cartTotal"]),isFormValid(){return this.checkoutForm.name&&this.checkoutForm.phone&&!this.errors.name&&!this.errors.phone}},methods:{...(0,X.i0)("cart",["removeFromCart","clearCart"]),async handleCheckout(){if(this.validateForm())try{const e={name:this.checkoutForm.name,phone:this.checkoutForm.phone,checkoutDate:(new Date).toISOString()},t=await this.$store.dispatch("cart/checkout",e);t.success?this.$router.push({name:"checkout-success",params:{orderId:t.order.orderId}}):console.error("Checkout failed:",t.error)}catch(e){console.error("Checkout error:",e)}},validateForm(){let e=!0;this.errors={name:"",phone:""},this.checkoutForm.name.trim()?this.checkoutForm.name.length<2&&(this.errors.name="Name must be at least 2 characters",e=!1):(this.errors.name="Name is required",e=!1);const t=/^[0-9]{10,}$/;return this.checkoutForm.phone.trim()?t.test(this.checkoutForm.phone)||(this.errors.phone="Please enter a valid phone number",e=!1):(this.errors.phone="Phone number is required",e=!1),e},async handleRemoveItem(e){try{await this.removeFromCart(e.id)}catch(t){console.error("Failed to remove item:",t)}},async handleCheckout(){if(this.validateForm()){this.loading=!0;try{await new Promise((e=>setTimeout(e,1e3)));const e={items:this.sortedCartItems.map((e=>e.id)),name:this.checkoutForm.name,phone:this.checkoutForm.phone,total:this.cartTotalWithTax,orderDate:(new Date).toISOString()};console.log("Order placed:",e),await this.clearCart(),this.checkoutForm={name:"",phone:""},alert("Order placed successfully!")}catch(e){console.error("Checkout failed:",e)}finally{this.loading=!1}}}}};const ee=(0,z.A)(Z,[["render",S],["__scopeId","data-v-94cbec60"]]);var te=ee,ae={components:{ShoppingCart:te}};const se=(0,z.A)(ae,[["render",r]]);var re=se}}]);
//# sourceMappingURL=969.1cf044d5.js.map